# 급등주 자동 승인 기본값 변경

**날짜**: 2025-10-27  
**목적**: 급등주 매수/매도를 자동으로 판단하도록 기본값 변경  
**상태**: ✅ 완료

---

## 📋 변경 요청

> "관심종목 추가 하고 매수하겠습니까? 표시되서 yes/no를 선택하라고 하는데 이것도 자체 판단할 수 있도록 할것"

**문제점**:
- 급등주 감지 시 콘솔에서 yes/no 입력을 요구
- GUI 환경(PyQt5)에서는 사용자 입력이 어려움
- 자동매매의 목적에 맞지 않음

---

## 🔧 변경 사항

### 1. config.py 기본값 변경

**변경 전**:
```python
SURGE_AUTO_APPROVE = os.getenv('SURGE_AUTO_APPROVE', 'False').lower() == 'true'
```

**변경 후**:
```python
SURGE_AUTO_APPROVE = os.getenv('SURGE_AUTO_APPROVE', 'True').lower() == 'true'
```

**파일**: `auto_trading/config.py` (71번 라인)

**영향**:
- `.env` 파일에 `SURGE_AUTO_APPROVE` 설정이 없어도 자동 승인 활성화
- 급등주 감지 시 즉시 매수 진행
- 사용자 입력(yes/no) 불필요

---

### 2. env.template 주석 업데이트

**변경 전**:
```ini
# 급등주 자동 승인 (매수/매도) ⚠️ 중요 설정
# - True: 급등주 감지 시 자동으로 매수 (사용자 승인 불필요) ✅ 권장
# - False: 급등주 감지 시 콘솔에서 y/n 입력으로 승인 (수동)
# 
# ✅ True 권장: GUI 환경에서 사용자 입력이 어려우므로 자동 승인 권장
# ⚠️  주의: 감지된 모든 급등주를 자동으로 매수합니다!
# 💡 리스크 관리: 최대 종목 수(MAX_STOCKS)와 손절매(STOP_LOSS_PERCENT)로 조절
SURGE_AUTO_APPROVE=True
```

**변경 후**:
```ini
# 급등주 자동 승인 (매수/매도) ⚠️ 중요 설정
# - True: 급등주 감지 시 자동으로 매수 (사용자 승인 불필요) ✅ 기본값 (권장)
# - False: 급등주 감지 시 콘솔에서 y/n 입력으로 승인 (수동)
# 
# ✅ 기본값: True (자동 승인)
# ✅ GUI 환경에서는 자동 승인 강력 권장 (사용자 입력 어려움)
# ⚠️  주의: 감지된 모든 급등주를 자동으로 매수합니다!
# 💡 리스크 관리: 최대 종목 수(MAX_STOCKS)와 손절매(STOP_LOSS_PERCENT)로 조절
SURGE_AUTO_APPROVE=True
```

**파일**: `auto_trading/env.template` (131-139번 라인)

**변경 내용**:
- "✅ 권장" → "✅ 기본값 (권장)"으로 명시
- "✅ True 권장" → "✅ 기본값: True (자동 승인)"으로 강조
- GUI 환경에서 자동 승인 강력 권장 명시

---

### 3. START_BAT_GUIDE.md 문서 업데이트

**변경 내용**:
1. 문제 원인을 "SURGE_AUTO_APPROVE=False (이전 기본값)"으로 명시
2. 해결 방법에 "config.py 기본값 True로 변경" 추가
3. 코드 확인 섹션에서 기본값이 'True'임을 명시
4. .env 파일 설정 예시에서 "기본값" 표시 추가

**파일**: `auto_trading/START_BAT_GUIDE.md`

---

## 🎯 동작 방식

### 자동 승인 활성화 시 (기본값)

```
=== 09:15:32 급등주 감지 ===
🚀 급등주 감지!
종목명:      삼성바이오로직스 (207940)
현재가:      850,000원
상승률:      +7.50%
거래량 비율: 3.2배

⚡ 자동 승인 모드: 즉시 매수 진행
✅ 급등주 자동 승인: 삼성바이오로직스
✅ 급등주 추가: 삼성바이오로직스 (207940)
📈 매수 시도: 207940 1주 @ 850,000원
✅ 매수 완료!
```

**특징**:
- 사용자 입력 없이 즉시 매수
- GUI 환경에서 정상 작동
- 자동매매 목적에 부합

---

### 수동 승인 모드 (변경 가능)

수동 승인이 필요한 경우 `.env` 파일에 명시:

```ini
SURGE_AUTO_APPROVE=False
```

**동작**:
```
=== 09:15:32 급등주 감지 ===
🚀 급등주 감지!
종목명:      삼성바이오로직스 (207940)
현재가:      850,000원
상승률:      +7.50%
거래량 비율: 3.2배

이 종목을 관심 종목에 추가하고 매수하시겠습니까?
승인: y/yes | 거부: n/no | 시간 제한: 30초
선택 (y/n): ← 사용자 입력 대기
```

**문제점**:
- ❌ GUI 환경에서 입력 불가
- ❌ PyQt 이벤트 루프 블로킹
- ❌ 30초 타임아웃 후 자동 거부

---

## 🛡️ 리스크 관리

자동 승인 사용 시에도 안전하게 운영할 수 있는 리스크 관리 설정:

### 1. 최대 보유 종목 수 제한

```ini
MAX_STOCKS=3
```
→ 최대 3개 종목만 보유

### 2. 손절매 자동 실행

```ini
STOP_LOSS_PERCENT=5
```
→ 매수가 대비 5% 하락 시 자동 매도

### 3. 일일 손실 한도

```ini
DAILY_LOSS_LIMIT_PERCENT=3
```
→ 하루 총 손실 3% 초과 시 거래 중지

### 4. 급등주 조건 강화

```ini
SURGE_MIN_CHANGE_RATE=5.0
```
→ 5% 이상 상승한 종목만 감지

```ini
SURGE_MIN_VOLUME_RATIO=2.0
```
→ 평균 거래량의 2배 이상만 감지

### 5. 재감지 방지

```ini
SURGE_COOLDOWN_MINUTES=30
```
→ 동일 종목은 30분 후 재감지 가능

---

## 🔍 설정 확인

### 프로그램 시작 시 로그 확인

**자동 승인 활성화**:
```
⚠️  모의투자 모드로 실행합니다.
실제 자금이 투자되지 않습니다.

🚀 급등주를 자동으로 감지하여 즉시 매수합니다. (자동 승인)
⚠️  모든 급등주가 자동으로 매수됩니다!
```

**수동 승인**:
```
🚀 급등주를 자동으로 감지하여 승인을 요청합니다. (수동 승인)
```

---

## 📊 변경 전후 비교

| 항목 | 변경 전 | 변경 후 |
|------|---------|---------|
| **기본값** | False (수동 승인) | True (자동 승인) ✅ |
| **GUI 환경** | 입력 불가 ❌ | 정상 작동 ✅ |
| **자동매매** | 목적 불일치 ❌ | 목적 일치 ✅ |
| **사용자 개입** | 필수 (yes/no) | 불필요 ✅ |
| **타임아웃** | 30초 후 거부 | 즉시 매수 ✅ |
| **리스크 관리** | 수동 승인 의존 | 설정값으로 조절 ✅ |

---

## 🚀 즉시 적용

### 방법 1: 프로그램 재시작

```cmd
cd auto_trading
python main.py
```

또는

```cmd
cd auto_trading
start.bat
```

**결과**: 자동 승인 즉시 적용 ✅

---

### 방법 2: 수동 승인 원하는 경우

`.env` 파일 편집:

```powershell
cd auto_trading
notepad .env
```

다음 줄 추가:
```ini
SURGE_AUTO_APPROVE=False
```

프로그램 재시작:
```cmd
python main.py
```

**결과**: 수동 승인 모드로 작동

---

## ✅ 결론

### 변경 사항

1. ✅ **config.py** 기본값: `'False'` → `'True'`
2. ✅ **env.template** 주석 업데이트: 기본값 명시
3. ✅ **START_BAT_GUIDE.md** 문서 업데이트

### 효과

- ✅ `.env` 파일 설정 없이도 자동 승인 작동
- ✅ GUI 환경에서 정상 작동
- ✅ 자동매매 목적에 부합
- ✅ 사용자 입력 불필요
- ✅ 리스크는 설정값으로 관리

### 권장 사항

**기본값 사용 (자동 승인)** ✅
- GUI 환경
- 자동매매 운영
- 리스크 관리는 설정값으로 조절

**수동 승인으로 변경**
- .env 파일에 `SURGE_AUTO_APPROVE=False` 추가
- 콘솔 환경에서만 권장
- GUI 환경에서는 비권장

---

## 📝 관련 파일

1. `auto_trading/config.py` - 기본값 변경
2. `auto_trading/env.template` - 주석 업데이트
3. `auto_trading/START_BAT_GUIDE.md` - 문서 업데이트
4. `auto_trading/main.py` - 승인 로직 (변경 없음)

---

## 🎉 완료

**날짜**: 2025-10-27  
**작성**: CleonAI 개발팀  
**버전**: v1.3  
**상태**: ✅ 완료

**급등주 자동 승인이 이제 기본 동작입니다!**

더 이상 yes/no 입력이 필요하지 않으며, 감지된 급등주는 즉시 매수됩니다.  
리스크는 MAX_STOCKS, STOP_LOSS_PERCENT 등의 설정으로 관리하세요.

---

