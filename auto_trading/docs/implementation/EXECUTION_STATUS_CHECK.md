# 프로그램 실행 상태 확인 가이드

**날짜**: 2025-10-27  
**문제**: 프로그램 정상 실행 여부 불명확, 로그 파일 미생성

## 🔍 발견된 문제

### 1. ❌ 로그 파일이 생성되지 않음
```
오늘 날짜: 2025-10-27
최신 로그: 2025-10-24 (3일 전!)
```

**원인**:
- 프로그램이 실행되지 않았거나
- 로그 시스템이 초기화되지 않음

### 2. ❌ 실행 상태 확인 불가
- 프로그램이 실제로 동작하는지 알 수 없음
- 하트비트 없음

### 3. ❓ OpenAPI 연결 상태 불명확
- 비밀번호 입력이 필요한지 불명확
- 로그인 성공/실패 여부 불명확

## ✅ 개선 사항

### 1. 프로그램 시작 시 상세 로그

**콘솔 출력**:
```
╔══════════════════════════════════════════════════════════╗
║                                                          ║
║          🤖 CleonAI 자동매매 프로그램 v1.3              ║
║                                                          ║
║          키움증권 Open API 기반 자동매매 시스템          ║
║                                                          ║
╚══════════════════════════════════════════════════════════╝
📅 시작 시간: 2025-10-27 09:00:00
📁 작업 디렉토리: D:\cleonAI\auto_trading
```

**로그 파일**:
```
================================================================================
🚀 프로그램 시작 - 2025-10-27
================================================================================
📁 작업 디렉토리: D:\cleonAI\auto_trading
📝 로그 파일: logs/trading_2025-10-27.log
🐍 Python 버전: 3.13.8
설정 확인 중...
```

### 2. OpenAPI 로그인 상세 정보

**로그인 시도 시**:
```
================================================================================
🔐 키움증권 Open API 로그인
================================================================================
📌 공동인증서 창이 자동으로 표시됩니다
📌 인증서를 선택하고 비밀번호를 입력하세요
📌 별도의 계좌 비밀번호 입력은 필요하지 않습니다

⏳ 키움 Open API 로그인 시도 중...
   → 공동인증서 창이 표시됩니다 (약 5-10초 소요)
```

**로그인 성공 시**:
```
✅ 키움 Open API 연결 성공!
📋 발견된 계좌 수: 2개
✅ 모의투자 계좌 로그인 성공
   💳 계좌번호: 8113110311
   👤 사용자: 한상철
   🖥️  서버: 모의투자 서버
   🔗 연결 상태: 정상
```

### 3. 하트비트 (Heartbeat) 추가

**1분마다 자동 출력**:
```
💓 하트비트 - 09:00:00 | 정상 실행 중
💓 하트비트 - 09:01:00 | 정상 실행 중
💓 하트비트 - 09:02:00 | 정상 실행 중
```

이제 로그만 보면 프로그램이 정상 실행 중인지 즉시 확인 가능!

### 4. 5분마다 상태 요약

```
======================================================================
📊 자동매매 상태 요약
======================================================================
👀 관심 종목: 3개 - 005930, 000660, 035720
📡 가격 데이터: 150개 수신
🚀 급등주 모니터링: 활성 ✅
   후보군: 100개
   감지됨: 3개
📊 매매 신호 생성: 5회
======================================================================
```

## 📋 OpenAPI 로그인 FAQ

### Q1: 비밀번호 입력이 필요한가요?

**A**: 네, 하지만 **공동인증서 비밀번호만** 필요합니다.

- ✅ **필요**: 공동인증서 비밀번호
- ❌ **불필요**: 계좌 비밀번호
- ❌ **불필요**: 키움증권 홈페이지 로그인 비밀번호

### Q2: 로그인 프로세스

1. **프로그램 시작**
   ```
   python main.py
   ```

2. **공동인증서 창 자동 표시** (5-10초 소요)
   - 키움증권 Open API가 자동으로 창을 엽니다
   - 별도로 실행할 필요 없음

3. **인증서 선택 및 비밀번호 입력**
   - 인증서 선택
   - 공동인증서 비밀번호 입력
   - 확인 클릭

4. **로그인 완료**
   ```
   ✅ 키움 Open API 연결 성공!
   ```

### Q3: 로그인이 안 되는 경우

**증상**:
```
❌ 키움 Open API 연결 실패
   공동인증서 로그인을 취소했거나 실패했습니다
```

**해결 방법**:
1. 공동인증서가 올바르게 설치되어 있는지 확인
2. 인증서 유효기간 확인
3. KOA Studio에서 먼저 테스트
4. 인증서 비밀번호 확인

## 🔍 프로그램 정상 실행 확인 방법

### 방법 1: 로그 파일 확인 (권장)

```powershell
# 오늘 날짜 확인
Get-Date -Format "yyyy-MM-dd"

# 오늘 날짜의 로그 파일이 있는지 확인
Get-ChildItem auto_trading\logs\trading_2025-10-27.log

# 로그 실시간 모니터링
Get-Content auto_trading\logs\trading_2025-10-27.log -Wait -Tail 20
```

**정상 실행 시 보이는 로그**:
```
2025-10-27 09:00:00 | INFO | 🚀 프로그램 시작 - 2025-10-27
2025-10-27 09:00:05 | SUCCESS | ✅ 키움 Open API 연결 성공!
2025-10-27 09:00:10 | SUCCESS | ✅ 엔진 초기화 완료!
2025-10-27 09:00:15 | SUCCESS | 🚀 자동매매 시작!
2025-10-27 09:01:00 | INFO | 💓 하트비트 - 09:01:00 | 정상 실행 중
2025-10-27 09:02:00 | INFO | 💓 하트비트 - 09:02:00 | 정상 실행 중
```

### 방법 2: 프로세스 확인

```powershell
# Python 프로세스 확인
tasklist | findstr python

# 상세 정보
Get-Process python* | Format-Table Id, ProcessName, StartTime, CPU -AutoSize
```

### 방법 3: 하트비트 확인

로그에서 **1분마다** 하트비트 메시지 확인:
```
💓 하트비트 - 09:00:00 | 정상 실행 중
```

이 메시지가 보이면 프로그램이 **정상 실행 중**입니다!

## 📝 체크리스트

### 프로그램 시작 시

- [ ] 로그 파일이 오늘 날짜로 생성되었는가?
  ```powershell
  ls auto_trading\logs\trading_2025-10-27.log
  ```

- [ ] 프로그램 시작 메시지가 보이는가?
  ```
  🚀 프로그램 시작 - 2025-10-27
  ```

- [ ] OpenAPI 로그인 성공했는가?
  ```
  ✅ 키움 Open API 연결 성공!
  ```

- [ ] 계좌 정보가 표시되는가?
  ```
  💳 계좌번호: 8113110311
  ```

### 실행 중

- [ ] 하트비트가 1분마다 표시되는가?
  ```
  💓 하트비트 - 09:01:00 | 정상 실행 중
  ```

- [ ] 5분마다 상태 요약이 표시되는가?
  ```
  📊 자동매매 상태 요약
  ```

- [ ] 실시간 가격 데이터를 수신하는가?
  ```
  📊 실시간: 005930 76,500원 (+2.00%) | 데이터: 50개
  ```

## 🚀 문제 해결

### 로그 파일이 생성되지 않는 경우

**1. 프로그램이 실행 중인지 확인**:
```powershell
tasklist | findstr python
```

**2. 로그 디렉토리 권한 확인**:
```powershell
icacls auto_trading\logs
```

**3. 수동으로 로그 디렉토리 생성**:
```powershell
New-Item -ItemType Directory -Path auto_trading\logs -Force
```

**4. 프로그램 재시작**:
```powershell
# 기존 프로세스 종료
taskkill /F /IM python3.13.exe

# 재시작
cd auto_trading
python main.py
```

### 하트비트가 보이지 않는 경우

**원인**:
- 프로그램이 멈춤
- 장 시간이 아님 (하트비트는 장 시간에만 표시)

**확인**:
```powershell
# 최근 로그 확인
Get-Content auto_trading\logs\trading_2025-10-27.log -Tail 50
```

**해결**:
```powershell
# 프로그램 재시작
cd auto_trading
python main.py
```

### 로그인 창이 나타나지 않는 경우

**원인**:
- 키움 Open API+ 미설치
- 공동인증서 미설치

**해결**:
1. 키움증권 홈페이지에서 Open API+ 다운로드 및 설치
2. 공동인증서 설치 확인
3. KOA Studio에서 먼저 로그인 테스트

## 📊 정상 실행 예시

### 프로그램 시작

```
2025-10-27 09:00:00 | INFO     | ================================================================================
2025-10-27 09:00:00 | INFO     | 🚀 프로그램 시작 - 2025-10-27
2025-10-27 09:00:00 | INFO     | ================================================================================
2025-10-27 09:00:00 | INFO     | 📁 작업 디렉토리: D:\cleonAI\auto_trading
2025-10-27 09:00:00 | INFO     | 📝 로그 파일: logs/trading_2025-10-27.log
2025-10-27 09:00:00 | INFO     | 🐍 Python 버전: 3.13.8
2025-10-27 09:00:00 | INFO     | 설정 확인 중...
2025-10-27 09:00:05 | SUCCESS  | ✅ 키움 Open API 연결 성공!
2025-10-27 09:00:05 | INFO     | 📋 발견된 계좌 수: 2개
2025-10-27 09:00:05 | SUCCESS  | ✅ 모의투자 계좌 로그인 성공
2025-10-27 09:00:05 | INFO     |    💳 계좌번호: 8113110311
2025-10-27 09:00:05 | INFO     |    👤 사용자: 한상철
2025-10-27 09:00:05 | INFO     |    🖥️  서버: 모의투자 서버
2025-10-27 09:00:05 | INFO     |    🔗 연결 상태: 정상
```

### 실행 중 (하트비트)

```
2025-10-27 09:01:00 | INFO     | 💓 하트비트 - 09:01:00 | 정상 실행 중
2025-10-27 09:02:00 | INFO     | 💓 하트비트 - 09:02:00 | 정상 실행 중
2025-10-27 09:03:00 | INFO     | 💓 하트비트 - 09:03:00 | 정상 실행 중
```

### 5분마다 상태 요약

```
2025-10-27 09:05:00 | INFO     | ======================================================================
2025-10-27 09:05:00 | INFO     | 📊 자동매매 상태 요약
2025-10-27 09:05:00 | INFO     | ======================================================================
2025-10-27 09:05:00 | INFO     | 👀 관심 종목: 3개 - 005930, 000660, 035720
2025-10-27 09:05:00 | INFO     | 📡 가격 데이터: 150개 수신
2025-10-27 09:05:00 | INFO     | 🚀 급등주 모니터링: 활성 ✅
2025-10-27 09:05:00 | INFO     |    후보군: 100개
2025-10-27 09:05:00 | INFO     |    감지됨: 0개
2025-10-27 09:05:00 | INFO     | 📊 매매 신호 생성: 0회
2025-10-27 09:05:00 | INFO     | ======================================================================
```

## 🎉 결론

이제:
- ✅ 프로그램 시작을 명확히 확인 가능
- ✅ OpenAPI 연결 상태를 상세히 표시
- ✅ 1분마다 하트비트로 정상 실행 확인
- ✅ 5분마다 전체 상태 요약
- ✅ 로그 파일이 날짜별로 자동 생성
- ✅ 공동인증서 비밀번호만 필요 (계좌 비밀번호 불필요)

**지금 실행해서 확인해보세요!** 🚀

```powershell
cd auto_trading
python main.py
```

---

**작성**: CleonAI 개발팀  
**날짜**: 2025-10-27  
**버전**: v1.3  
**상태**: ✅ 완료



