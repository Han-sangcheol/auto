# 🔑 키움증권 Open API 신청 및 설치 가이드

## 📋 준비사항

### 1. 키움증권 계좌 개설
- 키움증권 홈페이지(https://www.kiwoom.com) 방문
- 온라인 계좌 개설 신청
- 신분증 및 필요 서류 준비

### 2. 공동인증서 발급
- 키움증권 사이트에서 공동인증서(구 공인인증서) 발급
- 또는 은행/우체국에서 발급받은 인증서 사용 가능
- 인증서는 PC에 저장

## 🎮 모의투자 신청

### 1. 키움증권 홈페이지 로그인
1. https://www.kiwoom.com 접속
2. 로그인

### 2. 모의투자 신청
1. 상단 메뉴에서 [트레이딩] → [모의투자] 선택
2. 모의투자 신청 페이지에서 신청
3. 모의투자 계좌번호 발급 (즉시 발급)
4. 초기 가상 자금: 5,000만원

### 3. 모의투자 비밀번호 설정
- 계좌 비밀번호 설정 (4자리 숫자)
- 이 비밀번호는 API 로그인 시 필요

## 🔌 Open API+ 신청 및 설치

### 1. Open API+ 신청
1. 키움증권 홈페이지 로그인
2. [트레이딩] → [시스템트레이딩] → [Open API+] 메뉴
3. 'Open API+ 신청하기' 클릭
4. 약관 동의 후 신청 완료
5. 즉시 승인 (별도 심사 없음)

### 2. Open API+ 다운로드
1. 동일 페이지에서 'Open API+ 다운로드' 클릭
2. 설치 파일 다운로드 (KOAStudioSetup.exe)
3. 다운로드한 파일 실행

### 3. Open API+ 설치
```
설치 경로: C:\OpenAPI (기본값)
```

#### 설치 순서
1. KOAStudioSetup.exe 실행
2. '다음' 클릭하여 설치 진행
3. 설치 경로 확인 (변경 가능하지만 기본값 권장)
4. 설치 완료까지 기다림
5. 설치 완료 후 재부팅 (권장)

### 4. 설치 확인
설치 후 다음 파일들이 생성되었는지 확인:
```
C:\OpenAPI\
├── KHOpenAPI.dll 
├── KHOpenAPILib.dll
└── 기타 관련 파일들
```

## 🧪 API 연결 테스트

### 1. KOA Studio 실행
1. 시작 메뉴에서 'KOA Studio' 검색
2. KOA Studio 실행
3. 로그인 테스트
   - 모의투자 선택
   - 공동인증서로 로그인

### 2. 로그인 성공 확인
- 로그인 성공 시 계좌번호 표시
- 기본 시세 조회 테스트

## 💻 Python 개발 환경 구축

### 1. Python 설치
```bash
# Python 3.11 다운로드 및 설치
https://www.python.org/downloads/

# 설치 시 "Add Python to PATH" 체크 필수
```

### 2. Python 버전 확인
```bash
python --version
# Python 3.11.x 출력 확인
```

### 3. 가상환경 생성
```bash
# 프로젝트 폴더 생성
mkdir auto_trading
cd auto_trading

# 가상환경 생성
python -m venv venv

# 가상환경 활성화
venv\Scripts\activate
```

### 4. 필요 패키지 설치
```bash
pip install PyQt5==5.15.9
pip install pandas==2.0.3
pip install numpy==1.25.2
pip install python-dotenv==1.0.0
pip install loguru==0.7.0
```

## 🔧 환경 설정

### 1. .env 파일 생성
프로젝트 루트에 `.env` 파일 생성:
```env
# 키움증권 계좌 정보
KIWOOM_ACCOUNT_NUMBER=8123456789  # 모의투자 계좌번호
KIWOOM_ACCOUNT_PASSWORD=1234      # 계좌 비밀번호 (4자리)

# 거래 설정
USE_SIMULATION=True               # True: 모의투자, False: 실계좌
MAX_STOCKS=3                      # 최대 보유 종목 수
POSITION_SIZE_PERCENT=10          # 종목당 투자 비율 (%)
STOP_LOSS_PERCENT=5               # 손절매 비율 (%)
TAKE_PROFIT_PERCENT=10            # 익절매 비율 (%)
DAILY_LOSS_LIMIT_PERCENT=3        # 일일 손실 한도 (%)

# 관심 종목 설정 (종목코드 6자리)
WATCH_LIST=005930,000660,035720   # 삼성전자, SK하이닉스, 카카오
```

### 2. 종목 코드 찾기
- 네이버 증권(https://finance.naver.com) 에서 검색
- 종목명 검색 후 URL에서 6자리 코드 확인
- 예: 삼성전자 → 005930

## ✅ 설치 완료 체크리스트

- [ ] 키움증권 계좌 개설 완료
- [ ] 공동인증서 발급/등록 완료
- [ ] 모의투자 신청 완료 (계좌번호 발급)
- [ ] Open API+ 신청 완료
- [ ] Open API+ 설치 완료
- [ ] KOA Studio 로그인 테스트 성공
- [ ] Python 3.11 설치 완료
- [ ] 가상환경 생성 완료
- [ ] 필요 패키지 설치 완료
- [ ] .env 파일 생성 및 설정 완료

## 🚨 주의사항

### 중요 보안 수칙
1. **절대로 .env 파일을 Git에 커밋하지 마세요**
2. 계좌번호와 비밀번호는 안전하게 보관
3. 모의투자로 충분히 테스트 후 실계좌 사용

### API 사용 제한
1. **일일 조회 제한**: 1,000건/일 (일반 고객)
2. **초당 조회 제한**: 5건/초
3. **동시 접속**: 계좌당 1개 프로세스만 가능
4. 제한 초과 시 일시적으로 API 사용 불가

### 모의투자 vs 실계좌
| 구분 | 모의투자 | 실계좌 |
|------|---------|--------|
| 자금 | 가상 5천만원 | 실제 자금 |
| 리스크 | 없음 | 실제 손실 가능 |
| 체결 | 시뮬레이션 | 실제 체결 |
| 수수료 | 없음 | 실제 부과 |
| API 제한 | 동일 | 동일 |

## 🆘 문제 해결

### Q1. Open API+ 설치가 안 됩니다
**A**: 
- 관리자 권한으로 실행
- 보안 프로그램 일시 중지
- Windows 재부팅 후 재시도

### Q2. KOA Studio 로그인이 안 됩니다
**A**:
- 공동인증서가 올바르게 설치되었는지 확인
- 모의투자/실계좌 선택 확인
- 인증서 유효기간 확인
 
### Q3. PyQt5 설치 오류
**A**:
```bash
# pip 업그레이드
python -m pip install --upgrade pip

# 다시 설치
pip install PyQt5==5.15.9
```

### Q4. 모의투자 계좌가 안 보입니다
**A**:
- 키움증권 홈페이지에서 모의투자 신청 확인
- 계좌번호가 정확한지 확인
- KOA Studio에서 '모의투자' 체크박스 선택

## 📞 고객 지원

### 키움증권 고객센터
- 전화: 1544-9000
- Open API 문의: 내선 2번 → 1번
- 운영 시간: 평일 09:00 - 18:00

### 온라인 자료
- 키움 Open API 매뉴얼: KOA Studio에서 다운로드
- 개발자 커뮤니티: 네이버 카페 '키움 Open API'

---

**작성일**: 2025년 10월 16일  
**버전**: 1.0.0

이제 다음 단계인 프로그램 개발로 진행하시면 됩니다! 🚀

