# 오늘(10월 30일) 에러 발생 타임라인

## 📊 요약

| 시간 | 문제 | 원인 | 상태 |
|------|------|------|------|
| 07:56 | 비밀번호 마스킹 | 디버깅 어려움 | ✅ 해결 (수정 완료) |
| 09:02 | -301 에러 (비밀번호 오류) | 계좌번호 불일치 | ⚠️ 진행 중 |
| 10:32 | -301 에러 반복 | 계좌번호 여전히 불일치 | ⚠️ .env 수정 필요 |
| 10:38 | -202 에러만 발생 | 조회 과부하 (정상) | ✅ 비밀번호 문제 해결된 것으로 보임 |

---

## 📋 상세 로그

### 1️⃣ 첫 실행 (07:56) - 수정 전
```
07:56:51 | INFO  | 계좌 비밀번호: 설정됨 (****)  ← 마스킹되어 실제 값 확인 불가
07:57:20 | INFO  | 💳 계좌번호: 8113110311
07:57:24 | ERROR | ❌ 잔고 조회 실패: -202 (조회 과부하)
07:57:29 | ERROR | ❌ 보유종목 조회 실패: -202
```
**문제**: 비밀번호가 마스킹되어 디버깅 어려움

---

### 2️⃣ 두 번째 실행 (09:01) - 코드 수정 후
```
09:01:17 | INFO  | 계좌 비밀번호: 설정됨 (0000)  ← 수정됨! ✅
09:01:17 | INFO  | ✅ 비밀번호 '0000'으로 설정 확인됨
09:01:35 | INFO  | 💳 계좌번호: 8113110311
09:01:44 | ERROR | ❌ 잔고 조회 실패: -202
09:01:46 | ERROR | ❌ 보유종목 조회 실패: -202
09:02:09 | ERROR | ❌ 매수 주문 실패 (코드: -301): 170030  ← 비밀번호 오류!
09:02:11 | ERROR | ❌ 매수 주문 실패 (코드: -301): 170030
09:02:12 | ERROR | ❌ 매수 주문 실패 (코드: -301): 170030
09:02:12 | ERROR | ⛔ 최대 재시도 횟수 초과 (3회)
```
**문제**: -301 에러 = 계좌 비밀번호 오류
**원인**: .env의 계좌번호와 로그인 계좌 불일치

---

### 3️⃣ 세 번째 실행 (10:32) - .env 잘못 수정
```
10:32:12 | ERROR | ❌ 잔고 조회 실패: -202
10:32:15 | ERROR | ❌ 보유종목 조회 실패: -202
10:32:25 | ERROR | ❌ 매수 주문 실패 (코드: -301): 215790  ← 여전히 비밀번호 오류!
10:32:50 | ERROR | ❌ 매수 주문 실패 (코드: -301): 215790
10:32:56 | ERROR | ❌ 매수 주문 실패 (코드: -301): 215790
10:32:56 | ERROR | ⛔ 최대 재시도 횟수 초과 (3회)
```
**문제**: 여전히 -301 에러
**원인**: .env 계좌번호가 `81131103` 또는 `811311031111`로 잘못 입력됨

---

### 4️⃣ 최신 실행 (10:38) - 현재 진행 중
```
10:38:11 | ERROR | ❌ 잔고 조회 실패: -202 (조회 과부하)
10:38:23 | ERROR | ❌ 보유종목 조회 실패: -202
```
**상태**: 
- -301 에러 없음! ✅
- -202는 정상적인 조회 과부하 (키움 API 제한)
- 아직 매수 시도가 없어서 비밀번호 문제 해결 여부 미확인

---

## 🔍 문제 분석

### -301 에러 (계좌 비밀번호 오류)
- **증상**: 매수 주문 시 `-301` 에러 발생, 화면에 "22번" 또는 "2133번" 에러 표시
- **원인**: `.env` 파일의 계좌번호와 실제 로그인 계좌 불일치
  ```
  .env 설정: 81131103 또는 811311031111 (잘못됨)
  로그인 계좌: 8113110311 (10자리)
  ```
- **결과**: 비밀번호 `0000`은 다른 계좌의 비밀번호이므로 주문 실패

### -202 에러 (조회 과부하)
- **증상**: 계좌 정보/보유종목 조회 실패
- **원인**: 키움 API 조회 제한 (정상적인 제한)
- **영향**: 프로그램 동작에는 문제 없음 (기본값 사용)

---

## ✅ 해결 상태

### 완료된 수정
1. ✅ 비밀번호 마스킹 제거 → 실제 값 표시 (`0000`)
2. ✅ 비밀번호 검증 로직 추가 → 자동 확인
3. ✅ 계좌번호 전체 표시

### 진행 중
4. ⏳ .env 파일의 계좌번호를 `8113110311` (정확히 10자리)로 수정 필요

---

## 📝 다음 작업

1. **메모장에서 .env 파일 확인:**
   ```
   KIWOOM_ACCOUNT_NUMBER=8113110311  ← 정확히 10자리인지 확인
   KIWOOM_ACCOUNT_PASSWORD=0000
   ```

2. **프로그램 재실행:**
   ```
   .\start.bat
   ```

3. **로그 확인:**
   - "계좌 비밀번호: 설정됨 (0000)" ✅
   - "✅ 비밀번호 '0000'으로 설정 확인됨" ✅
   - "💳 계좌번호: 8113110311" ✅
   - 매수 시도 시 -301 에러 없어야 함 ✅

---

## 🎯 최종 확인 방법

프로그램 재실행 후:
```bash
cd auto_trading
python check_account.py
```

다음과 같이 표시되어야 합니다:
```
✅ 계좌번호 일치
• .env 설정: 8113110311
• 로그인 계좌: 8113110311
```


